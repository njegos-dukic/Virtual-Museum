<%@ page import="org.unibl.etf.virtualmuseum.entities.UserEntity"%>
<%@ page import="org.unibl.etf.virtualmuseum.services.UserService"%>
<%@ page language="java" contentType="text/html; charset=ISO-8859-1" pageEncoding="ISO-8859-1"%>
<jsp:useBean id="user" scope="session" type="org.unibl.etf.virtualmuseum.beans.UserBean"/>  
 
<%
	UserEntity me = null;

	if (!user.isLoggedIn()) {
		response.sendRedirect("Login.jsp");
	}
	
	else if (request.getParameter("logout") != null) {
		user.logOut();
		session.invalidate();
		response.sendRedirect("Login.jsp");
	}
	
	else {
		String name = request.getParameter("name");
		String address = request.getParameter("address");
		String phone = request.getParameter("phone");
		String city = request.getParameter("city");
		String country = request.getParameter("country");
		String type = request.getParameter("type");
		String maps = request.getParameter("maps");
	    if(name != null && address != null && phone != null && city != null && country != null && type != null && maps != null) {
	    	me = new UserEntity(0, name, address, phone, city, country, type, maps);
	    	UserEntity.insert(me);
	    	response.sendRedirect("Museums.jsp");
	    }
	}
%>

<!DOCTYPE html>
<html lang="en">
	<head>
    	<meta charset="UTF-8">
    	<meta http-equiv="X-UA-Compatible" content="IE=edge">
    	<meta name="viewport" content="width=device-width, initial-scale=1.0">
    	<title>Virtual Museum Admin</title>
    	<link href="../css/Header.css" rel="stylesheet" type="text/css">
    	<link href="../css/AddEdit.css" rel="stylesheet" type="text/css">
    	<link rel="icon" href="../images/logo.png">
    	<link rel="preconnect" href="https://fonts.googleapis.com">
    	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    	<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap" rel="stylesheet"> 				
	</head>
	
	<body>
		<div class="header-container">
            <div class="header-logo-container">
			    <img class="header-logo" src="../images/logo.png" />
            </div>

			<div class="header-title">
                VIRTUAL MUSEUM ADMINISTRATION
            </div>

			<div class="header-login-container">
				<form class="header-login-container" action="#" method="post">
	                <div class="header-login-label">
	                    <%= user.getUsername() %> &nbsp; &nbsp; 
	                </div>
	                <input type="hidden" name="logout" value="1" />
  					<span class="tooltiptext">Log out</span>
	                <input type="image" class="header-login-image tooltip" src="../images/login.png" />
                </form>
            </div>
		</div>
		
		<div class="museum-edit-container">
	        <form action="#" method="post" class="museum-edit-form">
	            <div class="museum-edit-single-input">
	                <label class="museum-edit-input-label" for="name">Museum name: </label>
	                <input class="museum-edit-input-field" name="name" type="text">
	            </div>
	            <div class="museum-edit-single-input">
	                <label class="museum-edit-input-label" for="address">Museum address: </label>
	                <input class="museum-edit-input-field" name="address" type="text" required>
	            </div>
	            <div class="museum-edit-single-input">
	                <label class="museum-edit-input-label" for="phone">Museum phone: </label>
	                <input class="museum-edit-input-field" name="phone" type="text" required>
	            </div>
	            <div class="museum-edit-single-input">
	                <label class="museum-edit-input-label" for="country">Museum country: </label>
	                <select id="countries-select" class="museum-edit-input-field" name="country" required>
	                
	                </select>
	            </div>
	            <div class="museum-edit-single-input">
	                <label class="museum-edit-input-label" for="city">Museum city: </label>
	                <select id="cities-select" class="museum-edit-input-field" name="city" required>
	                
	                </select>
	            </div>
	            <div class="museum-edit-single-input">
	                <label class="museum-edit-input-label" for="type">Museum type: </label>
	                <input class="museum-edit-input-field" name="type" type="text" required>
	            </div>
	            <div class="museum-edit-single-input">
	                <label class="museum-edit-input-label" for="maps">Museum location: </label>
	                <input class="museum-edit-input-field" name=maps type="text" required>
	            </div>
	            <div class="museum-edit-single-input margin-botton-4perc">
	                <input class="museum-edit-input-field" type="submit" value="Add Museum">
	            </div>
	        </form>
	    </div>
	</body>
</html>